BLUEKING.searchbar=function(){return{init:function(){$("#search-suggest .resultBox-div").mCustomScrollbar({theme:"minimal",callbacks:{onInit:function(){$("#search-suggest .resultBox-div").removeAttr("style"),$("#search-suggest .resultBox-div").css({"max-height":"400px",position:"relative",overflow:"visible"})}}}),$("#pageletSearchInput").on("click",function(){return!1}),$("#search-suggest .resultBox").on("click","li",function(){switch($(this).attr("type")){case"app":BLUEKING.window.create($(this).attr("appcode"),"",$(this).attr("appcode"),1)}}),$("#search-suggest .openAppMarket a, #pageletSearchButton").on("click",function(){BLUEKING.searchbar.openAppMarket($("#pageletSearchInput").val())}),$("#pageletSearchInput").on("keydown",function(e){"13"==e.keyCode&&(0==$("#search-suggest .resultBox .resultList a.selected").length&&0==$("#search-suggest > .resultList a.selected").length?BLUEKING.searchbar.openAppMarket($(this).val()):$("#search-suggest .resultList a.selected").click())}),$("#pageletSearchInput").focus(function(){"undefined"!=typeof searchFunc&&null!=searchFunc||BLUEKING.searchbar.get()}),$("#pageletSearchInput").blur(),$("#search-bar").show()},get:function(){var e="";searchFunc=setInterval(function(){var s=$("#pageletSearchInput").val();""!=s?(s!=e?(e=s,BLUEKING.searchbar.getSuggest(s)):$("#search-suggest").show(),$("#search-bar").removeClass("above").addClass("above")):($("#search-suggest").hide(),$("#search-bar").removeClass("above"))},1e3),BLUEKING.searchbar.set(),Mousetrap.bind(["up"],function(){if(0==$("#search-suggest .resultBox .resultList a.selected").length&&0==$("#search-suggest > .resultList a.selected").length)$("#search-suggest > .resultList:last a").addClass("selected");else if($("#search-suggest .resultBox .resultList:first a").hasClass("selected"))$("#search-suggest .resultList a").removeClass("selected");else{if(0!=$("#search-suggest > .resultList a.selected").length){var e=$("#search-suggest > .resultList a.selected").parent(".resultList").index();$("#search-suggest .resultList a").removeClass("selected"),e>1?$("#search-suggest > .resultList:eq("+(e-1)+") a").addClass("selected"):$("#search-suggest .resultBox .resultList:last a").addClass("selected")}else{var e=$("#search-suggest .resultBox .resultList a.selected").parent(".resultList").index();$("#search-suggest .resultList a").removeClass("selected"),e>0&&$("#search-suggest .resultBox .resultList:eq("+(e-1)+") a").addClass("selected")}$("#search-suggest .resultBox-div").mCustomScrollbar("scrollTo","+=30")}return!1}),Mousetrap.bind(["down"],function(){if(0==$("#search-suggest .resultBox .resultList a.selected").length&&0==$("#search-suggest > .resultList a.selected").length)0==$("#search-suggest .resultBox .resultList").length?$("#search-suggest > .resultList:first a").addClass("selected"):$("#search-suggest .resultBox .resultList:first a").addClass("selected");else if($("#search-suggest > .resultList:last a").hasClass("selected"))$("#search-suggest .resultList a").removeClass("selected");else{if(0!=$("#search-suggest .resultBox .resultList a.selected").length){var e=$("#search-suggest .resultBox .resultList a.selected").parent(".resultList").index();$("#search-suggest .resultList a").removeClass("selected"),e<$("#search-suggest .resultBox .resultList").length-1?$("#search-suggest .resultBox .resultList:eq("+(e+1)+") a").addClass("selected"):$("#search-suggest > .resultList:first a").addClass("selected")}else{var e=$("#search-suggest > .resultList a.selected").parent(".resultList").index();$("#search-suggest .resultList a").removeClass("selected"),e<$("#search-suggest > .resultList").length-1?$("#search-suggest > .resultList:eq("+(e+1)+") a").addClass("selected"):$("#search-suggest .resultBox .resultList:first a").addClass("selected")}$("#search-suggest .resultBox-div").mCustomScrollbar("scrollTo","-=30")}return!1}),Mousetrap.bind(["backspace"],function(){return!0})},set:function(){$("#search-bar").show(),$("#search-suggest .resultList a").removeClass("selected"),$("#pageletSearchInput").focus()},getSuggest:function(e){var s="";$.get(urlPrefix+"search_apps/",{search:e},function(e){var t=e.apps;for(i=0;i<t.length;i++)s+=suggestTemp({name:t[i].name,appid:t[i].appid,type:t[i].type,code:t[i].code});$("#search-suggest .resultBox").html(s),""==s?$("#search-suggest .resultBox").hide():$("#search-suggest .resultBox").show(),BLUEKING.searchbar.set(),$("#search-suggest").show()},"json")},openAppMarket:function(e){""!=e&&BLUEKING.window.create_market_search(e),BLUEKING.searchbar.hide()},hide:function(){"undefined"!=typeof searchFunc&&(clearInterval(searchFunc),searchFunc=null),$("#search-bar").removeClass("above"),$("#search-suggest").hide(),$("#pageletSearchInput").val(""),$("#search-suggest .resultBox").html(""),Mousetrap.unbind(["up","down"])}}}();